# First rule - delete all
-D
#
# # increase the buffers to survive stress events. make this bigger for busy systems.
-b 1024
#
# # monitor unlink() and rmdir() system calls.
-a exit,always -S unlink -S rmdir
#
# # monitor open() system call by Linux UID 1001.
-a exit,always -S open -F loginuid=1000
#
# # monitor write-access and change in file properties (read/write/execute) of the following files.
-w /etc/group -p wa
-w /etc/passwd -p wa
-w /etc/shadow -p wa
-w /etc/sudoers -p wa
#
#
{% if grains.get('shiftenv') or grains.get('liskenv') or grains.get('lwfenv') or grains.get('oxyenv') %}
-a exit,always -F path={{ pillar.get('app_dir') }}config.json -F perm=wa
{% endif %}
#
# lock the audit configuration to prevent any modification of this file.
# dont lock it just yet
#-e 2
